\documentclass[a4j]{jarticle}
\usepackage[dvipdfmx]{graphicx}
\usepackage{eclclass}
\usepackage{url}

\title{{\large 情報学群実験第２ レポート}\\[1ex]
  音を鳴らす}

% グループレポートの場合
\author{1180296 内田裕基       
   \and 1180302 奥井里永子 
   \and 1180303 奥田麻友  \noindent
   \and 1180328 近藤直季   
   \and 1180335 佐野稜太　 
   \and 1180387 山崎侑一   
}

\date{2015年12月1日}

\begin{document}
\maketitle

%%% 導入 (introduction)
\section{実験の目的}

\input{mokuteki}

%%% 外部仕様・内部仕様
\section{プログラムの外部仕様}

\input{gaibu}

\section{プログラムの内部仕様}

\input{naibu1}
\input{naibu2}

%%% 実験
\section{実験}

\input{jikken}

%%% 考察
\section{考察}

\input{kousatu}

\section*{執筆分担}
 %グループレポートの場合はここに「執筆分担」という節を置き，誰がどの部
 %分の執筆を担当したか記述する（本科目独自の規則）．
 %どのレポート課題についても，全員がいずれかの部分の執筆を担当すること．\\
\noindent
本レポートでは, 以下の担当構成をとっている. \\
\noindent
　　1180296 内田裕基　 $\cdots$ 内部仕様\\    
　　1180302 奥井里永子 $\cdots$ 考察\\ 
　　1180303 奥田麻友　 $\cdots$ 実験\\ 
　　1180328 近藤直季　 $\cdots$ 内部仕様\\ 
　　1180335 佐野稜太　 $\cdots$ 外部仕様\\ 
　　1180387 山崎侑一　 $\cdots$ 実験目的\\ 


%%% 参考文献

% 本文で引用(\cite)したもののみを記載すること．

% この例では若干しつこく文献を参照(\cite)しているが，実験レポートにおい
% て文献を参照することは「自分の思い込みで書いているのではなく，ちゃん
% と調査している」ことを主張することになる．もちろん，文献にそのことが
% 書かれているか確認せずに参照するのは，一種の嘘を書いていることになる
% ので，行ってはいけない．

% 参考文献リストの書式（スタイル）は，通常は掲載誌ごとに決まっている．
% ここでは『電子情報通信学会和文論文誌 投稿のしおり（情報・システムソサ
% イエティ）』の2.6節「文献」に概ね従っている．
% http://www.ieice.org/jpn/shiori/iss_2.html#2.6
% スタイルは掲載誌ごとに変わるが，必要な項目はだいたい同じである
% （「読者がその文献を入手するための情報を提供する」という目的は同じな
% ので）．（BibTeXを使えば，書式を整えるのは機械がやってくれる．）
%
% なお，上記のしおりには，文献を並べる順序の指定がないが，通常は以下の
% 2つのうちどちらかに従う．
% (1) 第一著者の姓（名ではないので注意）のアルファベット順．
% (2) 本文での引用順．
% ここでは(1)を採った．

\begin{thebibliography}{9}

  % 第何版であるか（英語だとedition）はとても重要．
  % ページ番号で範囲を指定する代わりに章番号と章名で指定している．
  % 発行所名は正しくは株式会社アスキーだが，「株式会社」等は省略するのが慣わし．
  % 必ず巻末の奥付を見て，著者，書名，発行所，発行年を確認すること．
  % 版も刷も複数ある場合，その版の第1刷の発行年を文献リストに記載する．

  % TeXでは，二重引用符は `` '' と入力することで表す．
  %
  % URLのように途中で改行できない文字列があると，Underfullを起こしやすい．
  % 必要なら \allowbreak か \\ を挟んで改行させるとよい．
  % \allowbreak は「改行可能」と指示するだけなので，改行されないこともある．
  % \\ は必ず改行される．\\ で改行すると左詰めになり，右に空白ができる．
  % badnessが5000を超える場合はかなり不格好になっているので修正すべき．
  % badnessが1000程度でも，修正した方がより綺麗な仕上がりになる．
  % この辺の見た目の調節は，最後の仕上げの段階で，組版結果を目で確認しながら行うとよい．

\bibitem{text}
  高知工科大学 情報学群実験第2担当教員, 2015情報学群実験第2, 第10章・第13章, 2015年10月
\bibitem{onkai}
  音楽教室wooper, 「音名と周波数」, \url{<http://wooper.jp/sheet/hertz-and-name.pdf>}, 2015/11/27閲覧. 
  \bibitem{guren}
  GLNET Co.,Ltd., 「紅蓮の弓矢」, \url{<http://guitarlist.net/modules/pico/index.php?content_id=1350>}, 2015/11/26閲覧.
\bibitem{sky}
  DMBN, 「東方ピアノEasyモード 楽譜置き場」, \url{<http://easypianoscore.jp/>}, 2015/11/26閲覧.
\bibitem{time}
  ソフトのがらくた箱, 「ストップウォッチ」, \url{<http://park6.wakwak.com/~wmasa/soft/wbt/timer/>}. 2015/11/30閲覧.

\end{thebibliography}
\newpage
\appendix
\section{ソースコード}
\label{sec:sourcecode}

\subsection{beep.S}
{\small
\begin{verbatim}
    ;; 曲名1   紅蓮の弓矢
    ;; 作曲者  Revo
    ;; 楽譜の入手元
    ;; http://guitarlist.net/modules/pico/index.php?content_id=1350
    ;; アピールポイント
    ;; 細かい音を再現しました.
    ;; 一番最後のギターの部分が聞きどころです．
	
    ;; 曲名2   天空のグリニッジ
    ;; 作曲者  上海アリス幻樂団 ZUN
    ;; 楽譜の入手元
    ;; http://easypianoscore.jp/
    ;; アピールポイント
    ;; 激しいメロディーを再現しました．
    ;; 一部，主旋律を外してヘ音部分を取り入れました．

        .equ    TCR0,    0xFFC8
        .equ    TCSR0,   0xFFC9
        .equ    TCORA0,  0xFFCA
        .equ    TCORB0,  0xFFCB
        .equ    TCNT0,   0xFFCC

    /* 今回未使用の音階
        .equ    Do2,     238     ;ド2
        .equ    Dos2,    224     ;ド#2
        .equ    Re2,     212     ;レ2
        .equ    Res2,    200     ;レ#2
        .equ    Mi2,     189     ;ミ2
        .equ    Fa2,     178     ;ファ2
        .equ    Fas2,    168     ;ファ＃2
        .equ    So2,     158     ;ソ2
        .equ    Sos2,    150     ;ソ＃2
        .equ    Ra2,     141     ;ラ2
        .equ    Ras2,    133     ;ラ#2
        .equ    Si2,     126     ;シ2
    */
        .equ    Do3,     118     ;ド3
        .equ    Dos3,    112     ;ド#3
        .equ    Re3,     106     ;レ3
        .equ    Res3,     99     ;レ#3
        .equ    Mi3,      94     ;ミ3
        .equ    Fa3,      88     ;ファ3
        .equ    Fas3,     83     ;ファ#3
        .equ    So3,      79     ;ソ3
        .equ    Sos3,     74     ;ソ#3
        .equ    Ra3,      70     ;ラ3
        .equ    Ras3,     66     ;ラ#3
        .equ    Si3,      62     ;シ3
        .equ    Do4,      59     ;ド4
        .equ    Dos4,     55     ;ド#4
        .equ    Re4,      52     ;レ4
        .equ    Res4,     49     ;レ#4
        .equ    Mi4,      46     ;ミ4
        .equ    Fa4,      44     ;ファ4
        .equ    Fas4,     42     ;ファ#4
        .equ    So4,      39     ;ソ4
        .equ    Sos4,     37     ;ソ#4
        .equ    Ra4,      35     ;ラ4
        .equ    Ras4,     33     ;ラ#4
        .equ    Si4,      31     ;シ4
        .equ    Do5,      29     ;ド5
        .equ    Dos5,     28     ;ド#5
        .equ    Re5,      26     ;レ5
        .equ    Res5,     24     ;レ#5
        .equ    Mi5,      23     ;ミ5
        .equ    Fa5,      22     ;ファ5
        .equ    Fas5,     20     ;ファ#5
        .equ    So5,      19     ;ソ5
        .equ    Sos5,     18     ;ソ#5
        .equ    Ra5,      17     ;ラ5
        .equ    Ras5,     16     ;ラ#5
        .equ    Si5,      15     ;シ5
        .equ    Un,      0xFF

        .section .text
        .p2align 1
        .global _beep
_beep:      
        xor     r0l,     r0l
        mov     r0l,     @TCNT0:8

        mov     #0x16,   r0l
        mov     r0l,     @TCSR0
        mov     #mdata1, r3      ;開始番地の代入
_loop0:
        mov     @r3,     r0l	 ;番地の値を代入
        cmp     #0xFF,   r0l     ;空白の時else0へ
        beq     else0
        bsr     _sound           ;TCORA,TCORBの設定
        jmp     elseend
else0:
        mov     r0l,     @TCORA0
elseend:
        mov     #0x13,   r0l
        mov     r0l,     @TCR0   ;start the timer

        adds    #1,      r3      ;次のデータに
        mov     @r3,     r4l
_loop1:
        ;; 0.01 x r4l　秒
        bsr     _wait_001sec     ;0.01秒
        dec     r4l
        cmp     #0,r4l
        beq     _loop1end
        jmp     _loop1
_loop1end:
        ;; 1音の終了
    /*天空のグリニッジで使用
        mov     #Un,     r0l
        mov     r0l,     @TCORA0
        bsr     _wait_001sec
    */
        ;; 
        adds    #1,      r3      ;次のデータへ
        mov     @r3,     r0l
        cmp     #0,      r0l     ;データが0の時終了
        beq     _loop0end
        jmp     _loop0
_loop0end:
        mov     #0xFF,   r0l
        mov     r0l,     @TCORA0
        rts

_sound:
        ;; TCORBとTCORAの設定
        mov     r0l,     @TCORB0:8
        shlr    r0l
        mov     r0l,     @TCORA0
        rts

        ;; 0.01秒
_wait_001sec:
        mov.w   #1,      r2
        mov.w   #111,    r0
0:
        mov.w   #111,    r1
1:
        sub.w   r2,      r1
        bne     1b
        sub.w   r2,      r0
        bne     0b
        rts
\end{verbatim}
}
{\small
\begin{verbatim}
    ;; 音と時間のデータ
    .sction .data
    ;; 曲名   紅蓮の弓矢
\end{verbatim}
}
{\scriptsize
\begin{verbatim}
mdata1:
.byte   Dos5,10,Un,1, Dos5, 10,Un,1,  Mi5, 10,Un,1,Res5, 20, Un,1,Si4, 10,Un,1, Si4, 10,Un,1, Dos5, 20,Un,1
.byte   Dos5,10,Un,1,Mi5, 10,Un,1 ,Res5, 20,Un,1, Si4, 30
.byte   Do5,  3,Re5,3,Mi5,3	
.byte   Mi5, 20,Res3,1, Dos5, 10, Res5, 10, Res3, 10,  Si4, 10, Res3, 10, Dos5,10
.byte   Res3,10, Sos4, 10, Res3, 10,  Si4, 10, Res3, 10, Fas4, 30,Mi3,2
.byte   So5, 20,Fas3, 1,  Mi5, 10, Fas5, 10, Fas3, 10,  Re5, 10, Fas3, 10,  Mi5, 10
.byte   Fas3,10,  Re5, 10, Fas3, 10,  Do5, 10, Fas3, 10,  Si4, 30,Fas3, 2
.byte   Mi4,  9,Mi3,1,  Ra4, 9,Ra3,1,  Re5, 9, Re4,1, So5, 9,So4,1, Res5, 9,Res4,1, Ra4, 9, Ra3,1, Fa4, 9,Fa3,1
.byte   Fas4, 2,  So4,  2, Sos4,  2,  Ra4,  2, Ras4,  2,  Si4 ,2

.byte   Dos5, 10,Dos3,1, Dos5,10, Mi3,1, Mi5, 10, Dos3,1, Res5, 20, Dos3,1, Si4, 10, Dos4,8,Dos3,1
.byte   Dos5, 20, Dos3,1, Dos5,10,  Mi3,1, Mi5, 10,  Dos3,1, Res5, 19,  Si4, 16,Ra4,3,Si3,3
.byte   Dos5, 10,Dos3,1,  Dos5, 10,Dos3,1, Mi5, 10,Dos3,1, Res5, 20,Dos3,1
.byte   Dos5, 20,Dos3,1, Dos5, 30,Dos3,1,  Si4, 10,Dos3,1, Sos4, 20, Si4, 17
.byte   So4,   3,Ra4,3,Si4,3 
.byte   Dos5, 10,Dos3,1,Dos5,10
.byte   Mi5,  10,Dos3,1, Res5,20,Dos3,1, Si4, 10,Dos4,8,Dos3,1, Dos5, 20,Dos3,1, Dos5, 10,Dos3,1,  Mi5, 10,Dos3,1, Res5, 20,Dos3,1  
.byte   Si4,  16,Ra4,3,Si3,3, Dos5, 10,Dos3,1, Dos5, 10,Dos3,1,  Mi5, 10,Dos3,1, Res5, 20,Dos3,1,  Mi5, 10,Dos3,1, Fas5, 10,Dos3,1 
.byte   Si4,  20,Dos3,1, Sos5, 30,Dos3,1, Fas5, 30,Dos4,5,Res4,5,  Mi4, 5	
.byte   Dos5, 10,Fa3,1, Dos5, 10, Fa3,1, Mi5, 10,Fa3,1, Res5, 20,Fa3,1,  Si4, 10,Dos4,8
.byte   Dos3,  1, Dos5, 20, Dos3,1,Dos5,10,Mi3,1
.byte   Mi5,  10,Dos3,1, Res5, 19,  Si4, 16,Ra4,3,Ra4,3,Si3,3
.byte   Dos5, 10,Dos3,1, Dos5, 10,Dos3,1,  Mi5, 10,Mi3,1, Res5, 20
.byte   Dos5, 20,Dos3,1, Dos5, 30, Si4, 10,Dos3,1, Sos4, 20, Dos3,1, Si4, 16,Ra4,3,Si3,3
.byte   Dos5, 10,Dos3,1, Dos5,10,Dos3,1  
.byte   Mi5,  10,Dos3,1, Res5, 20,Dos3,1,Si4, 10, Dos4,8,Dos3,1, Dos5, 20,Dos3,1, Dos5, 10,  Mi5, 10,Dos3,1, Res5, 20
.byte   Dos3,  1, Si4, 10,Ra4,3,Si4,3,Dos3,1
.byte   Si4,  11, Dos5, 21 ,  Mi5, 11,  Res5, 21, Dos5, 11,  Si4, 11, Dos5, 28
.byte   Un,   10, Sos4, 10,   Un, 10,  Si4, 8,Do5,2,Re5,2

.byte   Mi5,  20,Res3,1, Dos5, 10, Res5, 10, Res3, 10,  Si4, 10, Res3, 10, Dos5, 10
.byte   Res3, 10, Sos4, 10, Res3,10,  Si4, 10, Res3, 10, Fas4, 30,Mi3,2
.byte   So5,  20,Fas3, 1,  Mi5, 10, Fas5, 10, Fas3, 10,  Re5, 10, Fas3, 10,  Mi5, 10
.byte   Fas3, 10,  Re5, 10, Fas3, 10,  Do5, 10, Fas3, 10,  Si4, 30,Fas3,2
.byte   Mi4,   6,Un,4,Ra3,6,Un,4,Mi5,20,Mi4,6,Un,4,Ra3,6,Un,4,Mi5,20,Mi4,6,Un,4,Ra3,6,Un,4,Mi5,20,Mi4,6,Un,4,Ra3,6,Un,4,Re5,20
.byte   Mi5,  20, Res3,1, Mi4,10, Res3, 1,Mi5,10,Un,10,Re4,10, Res3, 1,Mi5,20,Un,30

.byte   Ra5,   7,So5,7,  Re5,7,Ras4,7,Ra4,7
.byte   So4,   5,Ras4,5,Re5,5,So5,5,Ras5,5,So5,5,Re5,5,Ras4,5
.byte   Sos4,  5,Do5,5,Res5,5,Do5,5,Res5,5,Do5,5,Res5,5,Do5,5,Un,5
.byte   Fas5,  5,Re5,5,Ra4,5,Re5,5,Fas5,15
.byte   Ras5,  5,Fas5,5,So5,5,So5,5
.byte   Fa5,   7,Re5,7,Do5,7,  Re5,7,Ras4,7,Do5,7
.byte   Re5,   7, Fa5,  7, Do5, 7, Re5,  7
.byte   Ras4,  5, Do5,  5, Re5,10, Ra4,  5, Ra4, 5, Fa4,  5, So5, 5
.byte   Re4,   5, Fa4,  5, Do4, 5, Re4,  5
.byte   Ra4,   2, Ras4, 2, Ra4, 2, Ras4, 2, Ra4, 2, Ras4, 2, Ra4, 2, Ras4, 2, Ra4, 2, Ras4, 2
.byte   Ra4,   2, Ras4, 2, Ra4, 2, Ras4, 2, Ra4, 2, Ras4, 2, Ra4, 2, Ras4, 2, Ra4, 2, Ras4, 2
.byte   So4,  20, Fa4,  1, Mi4, 1, Re4,  1, Do4, 1, Si4,  1, 0
.end
\end{verbatim}
}
{\small
\begin{verbatim}
/*  コメントアウトを外し紅蓮の弓矢をコメントアウトすると!!
    ;; 曲名   天空のグリニッジ
\end{verbatim}
}
{\scriptsize
\begin{verbatim}
mdata1:
	;; 1-1
	.byte	Re5, 18, Re5, 18, Re5, 12 
	.byte	Dos5, 9, Dos5, 9, Dos5, 6
	.byte	Do5, 9, Ras4, 9, Ra4, 6
	;; 1-2
	.byte	Re5, 6, Ras4, 6, So4, 6, Re5, 6, Ras4, 6, So4, 6, Re5, 12
	.byte	Dos5, 9, Re5, 9, So5, 6, Re5, 24
	;; 1-3
	.byte	Re5, 6, Ras4, 6, So4, 6, Re5, 6, Ras4, 6, So4, 6, Re5, 12
	.byte	Dos5, 9, Dos5, 9, Dos5, 6
	.byte	Do5, 9, Ras4, 9, Ra4, 6
	;; 2-4 1-4とほぼ対応
	.byte	Re5, 6, Ras4, 6, So4, 6, Re5, 6, Ras4, 6, So4, 6, Re5, 12
	.byte	Dos5, 9, Re5, 9, Fa5, 6, So5, 24
	;; 3-1
	.byte	So4, 24, Re5, 24, Do5, 18, Re5, 18, Fa5, 12
	;; 3-2
	.byte	Do5, 18, Ras4, 18, Ra4, 12, So4, 24, So4, 12, Ra4, 12
	;; 3-3
	.byte	Ras4, 24, Ra4, 12, Ras4, 12, Do5, 12, Re5, 6, Res5, 6
	.byte	Res5, 6, Fa5, 6, Res5, 12
	;; 3-4
	.byte	Re5, 24, Un, 24, Re5, 12, Do5, 6, Re5, 6
	.byte	Ras4, 6, Do5, 6, Ra4, 6, Ras4, 6
	;; 4-1 1-3と対応(2-1)
	.byte	Re5, 6, Ras4, 6, So4, 6, Re5, 6, Ras4, 6, So4, 6, Re5, 12
	.byte	Dos5, 9, Dos5, 9, Dos5, 6
	.byte	Do5, 9, Ras4, 9, Ra4, 6
	;; 4-2 1-2と対応(2-2)
	.byte	Re5, 6, Ras4, 6, So4, 6, Re5, 6, Ras4, 6, So4, 6, Re5, 12
	.byte	Dos5, 9, Re5, 9, So5, 6, Re5, 24
	;; 4-3 1-3と対応(2-3)
	.byte	Re5, 6, Ras4, 6, So4, 6, Re5, 6, Ras4, 6, So4, 6, Re5, 12
	.byte	Dos5, 9, Dos5, 9, Dos5, 6
	.byte	Do5, 9, Ras4, 9, Ra4, 6
	;; 5-4 5-3と前半は対応
	.byte	Re5, 6, Ras4, 6, So4, 6, Re5, 6, Ras4, 6, So4, 6, Fa5, 12, So5, 24
	.byte	Fa5, 3, Mi5, 3, Res5, 3, Re5, 3, Dos5, 3, Do5, 3, Si4, 3, Ras4, 3
	;; 6-1
	.byte	So4, 36, Re5, 12, Ra4, 12, Ra4, 6, Ras4, 6, Ra4, 6, So4, 6, Fa4, 12
	;; 6-2
	.byte	So4, 48
	.byte	So3, 6, Si3, 6, Re4, 6, Ras3, 6, So3, 6, Ras3, 6, Re4, 3
	.byte	So4, 3, Fa4, 3, Mi4, 3
	;; 6-3
	.byte	So3, 12, Ra3, 12, Ras3, 12, Dos4, 24, Do4, 6
	.byte	Dos4, 6, Do4, 6, Ras3, 6, Ra3, 6
	;; 6-4	
	.byte	Re4, 12, So4, 12, Ras4, 12, Re5, 24, Do5, 6, Re5, 6, Ras4, 6, Ra4, 18
	;; 7-1 6-3と対応
	.byte	So3, 12, Ra3, 12, Ras3, 12, Dos4, 24, Do4, 6
	.byte	Dos4, 6, Do4, 6, Ras3, 6, Ra3, 6
	;; 7-2
	.byte	So4, 18, So4, 6, Re4, 6, Do4, 6, So4, 6, Re4, 6, Do4, 6
	.byte	So4, 6, Ra4, 6, Ras4, 6, So4, 6, Ra4, 6, Ras4, 6, Ra4, 6
	;; 8-3
	.byte	So4, 12, Ra4, 12, Ras4, 12, Dos5, 24
	.byte	Do5, 6, Dos5, 6, Do5, 6, Ras4, 6, Ra4, 12
	;; 8-4
	.byte	So4, 12, Ras4, 12, Re5, 12, So5, 24, Fas5, 6, So5, 6, Re5, 6, Do5, 18
	;; 9-1 8-3と対応
	.byte	So4, 12, Ra4, 12, Ras4, 12, Dos5, 24
	.byte	Do5, 6, Dos5, 6, Do5, 6, Ras4, 6, Ra4, 12
	;; 9-2
	.byte	So5, 18, So5, 6, Re5, 6, Do5, 6, So5, 6, Re5, 6, Do5, 6
	.byte	So5, 6, Ra5, 6, Ras5, 6, So5, 6, Ra5, 6, Ras5, 6, Ra5, 6
	;; 9-3 9-1と対応
	.byte	So4, 12, Ra4, 12, Ras4, 12, Dos5, 24
	.byte	Do5, 6, Dos5, 6, Do5, 6, Ras4, 6, Ra4, 12
	;; 9-4 8-4と対応
 	.byte	So4, 12, Ras4, 12, Re5, 12, So5, 24, Fas5, 6, So5, 6, Re5, 6, Do5, 18 
	;; 10-1 9-3と対応
 	.byte	So4, 12, Ra4, 12, Ras4, 12, Dos5, 24
	.byte	Do5, 6, Dos5, 6, Do5, 6, Ras4, 6, Ra4, 12
	;; 10-2
	.byte	So4, 12, Ras4, 12, Re5, 12, So5, 18
	.byte	Re5, 6, Fa5, 6, Do5, 6, Re5, 6, Ras4, 6, Do5, 6
	;; 10-3 1-1と対応
	.byte	Re5, 18, Re5, 18, Re5, 12 
	.byte	Dos5, 9, Dos5, 9, Dos5, 6
	.byte	Do5, 9, Ras4, 9, Ra4, 6
	;; 10-4 1-2と対応
	.byte	Re5, 6, Ras4, 6, So4, 6, Re5, 6, Ras4, 6, So4, 6, Re5, 12
	.byte	Dos5, 9, Re5, 9, So5, 6, Re5, 24
	;; ループを省く
	;; 20-3 2-3と対応
	.byte	Re5, 6, Ras4, 6, So4, 6, Re5, 6, Ras4, 6, So4, 6, Re5, 12
	.byte	Dos5, 9, Dos5, 9, Dos5, 6
	.byte	Do5, 9, Ras4, 9, Ra4, 6
	;; 20-4 2-4と対応
	.byte	Re5, 6, Ras4, 6, So4, 6, Re5, 6, Ras4, 6, So4, 6, Re5, 12
	.byte	Dos5, 9, Re5, 9, Fa5, 6, So5, 24, 0
	.end
*/
\end{verbatim}
}
{\small
\begin{verbatim}
;; 0〜9の一桁の数字をラベルとして使用可能(使い捨てラベル)
;; ジャンプ命令の引数には0b または0fのように書く
;; 0b : その行以前で最も近いラベル0
;; 0f : その行より後で最も近いラベル0

;; _wait_1sec は 「888回のループを999回繰り返すサブルーチン
;; 1命令実行するたびに少しずつ時間を消費し全体でやく1秒消費する
\end{verbatim}
}% \small

\subsection{crt0.S}
{\small
\begin{verbatim}
                .section .text
                .p2align 1
                .global _start
_start:         ldc     #0x80,     ccr          ; interrupt disable
; WDT
                mov.w   #0xA518,   r1
                mov.w   r1,        @0xFFA8      ; TCSR write

; System Control
                xor.b   r0l,       r0l

                mov.b   r0l,       @0xFFBB:8    ; P6DR = 0x00
                mov.b   #0x87,     r0h          ; P6-7(carrier),2/1/0(Sensor):out P6-6/5(LCD,4(spk),3:in 
                mov.b   r0h,       @0xFFB9:8    ; P6DDR

                bset    #0,        @0xFFBA:8    ; P5-0(TxD):1
                mov.b   #0xFD,     r0h          ; P5-2(On/Off out):out P5-1(RxD):in P5-0(TxD):out
                mov.b   r0h,       @0xFFB8:8    ; P5DDR

                mov.b   r0l,       @0xFFC3:8    ; STCR
                mov.b   r0l,       @0xFFC7:8    ; IER: disable all

; SCI: IR
                mov.b   r0l,       @0xFFDA:8    ; SCR
                mov.b   @0xFFDC:8, r0h          ; SSR
                mov.b   #0x84,     r0h
                mov.b   r0h,       @0xFFDC:8

; TMR0: speaker
                mov.b   r0l,       @0xFFC8:8    ; TCR0
                mov.b   @0xFFC9:8, r0h          ; TCSR0
                mov.b   r0l,       @0xFFC9:8

; TMR1: IR carrier
                mov.b   r0l,       @0xFFD0:8    ; TCR1
                mov.b   @0xFFD1:8, r0h          ; TCSR1
                mov.b   r0l,       @0xFFD1:8

; FRT: 1ms
                mov.b   r0l,       @0xFF96:8    ; TCR
                mov.b   r0l,       @0xFF90:8    ; TIER
                mov.b   @0xFF91:8, r0h          ; TCSR
                mov.b   r0l,       @0xFF91:8
                mov.b   r0l,       @0xFF97:8    ; TOCR

; A/D: inputs
                mov.b   r0l,       @0xFFE9:8    ; ADCR
                mov.b   @0xFFE8:8, r0h          ; ADCSR
                mov.b   r0l,       @0xFFE8:8

                ldc     #0x00,     ccr          ; interrupt enable

; user program
                jsr     _beep



; utility program
_cold_boot:     mov.w   #0xA57F,   r1           ; reset by WDT
                mov.w   r1,        @0xFFA8      ; TCSR write
         9:     bra     9b                      ; wait 256*4096 ticks util reset

_warm_boot:     mov.w   @0,        r0           ; get reset address from RCX Executable
                jmp     @r0

; keyword for RCX Executive
                .section .data
                .string "Do you byte, when I knock?"

                .end
\end{verbatim}
}% \small

\subsection[Makefile]{Makefile\protect\footnote{ファイル名がmakefileでも動くがMakefileが推奨される. \\ Makefileとmakefileの両方がある場合はmakefileが優先される.}}
{\small
\begin{verbatim}
AS  = h8300-elf-as -o
LD  = h8300-elf-ld -o
OC  = h8300-elf-objcopy -O
TT  = -Ttext 0x8000
TTE = -Ttext 0x8000 -e _start

#疑似ターゲットである事を明示
.PHONY: clean 

#10.2拡張子の指定
.SUFFIXES: .o .S .elf

#$<:最初に依存するファイル名(test_prime.s OR prime.c) 
#$+:Makefileと同じ順番の依存するファイルの名前
#$@:ターゲットファイル名(test_prime.o prime.o)

#kadai4 beep.oファイルから.elfへの変更した後，.motファイル生成
kadai4.mot: beep.o crt0.o		
        h8300-elf-ld beep.o crt0.o -o beep.elf $(TTE)
        $(OC) srec beep.elf $@

#以下演習問題10
reset.o: reset.S
        $(AS) $@ $<

reset.elf: reset.o
        $(LD) $@ $< $(TT)
#10.3
motor_test.o: motor_test.S
        $(AS) $@ $<

motor_test.elf: motor_test.o
        $(LD) $@ $< $(TT)

#10.4(2)-c 
%.mot: %.elf 
        $(OC) srec $< $@
%.o: %.S
        $(AS) $@ $<

%.elf: %.o
        $(LD) $@ $< $(TT)



#その他(疑似ターゲット)

clean:
        rm -f *.o *.mot *.elf


\end{verbatim}
}% \small

\newpage
\section{音の即値や周波数などについて}
\label{Hz}
\begin{table}[h]
  \begin{tabular}{cc}
    \begin{minipage}{0.5\hsize}
      \centering
      \caption{音の即値や周波数などについて1} 
      \label{Hz1}
      \begin{tabular}{c|c|c|c|c}
        音名 & 即値 & 周波数 & \parbox{3zw}{本来の周波数} & 誤差 \\
        \hline
        ド2 & 238 & 65.4 & 65.4 & 0 \\
        ド\#2 & 224 & 69.4 & 69.3 & +0.1 \\
        レ2 & 212 & 73.4 & 73.4 & 0 \\
        レ\#2 & 200 & 77.7 & 77.8 & -0.1 \\
        ミ2 & 189 & 82.2 & 82.4 & -0.2  \\
        ファ2 & 178 & 87.3 & 87.3 & 0 \\
        ファ\#2 & 168 & 92.5 & 92.5 & 0  \\
        ソ2 & 158 & 98.3 & 98.0 & +0.3 \\
        ソ\#2 & 150 & 103.5 & 103.8 & -0.3 \\
        ラ2 & 141 & 110.0 & 110.0 & 0 \\
        ラ\#2 & 133 & 116.6 & 116.5 & +0.1 \\
        シ2 & 126 & 123.0 & 123.5 & -0.5 \\
        ド3 & 118 & 131.3 & 130.8 & +0.5 \\
        ド\#3 & 112 & 138.3 & 138.6 & -0.3 \\
        レ3 & 106 & 146.0 & 146.8 & -0.8 \\
        レ\#3 & 99 & 156.3 & 155.7 & +0.6 \\
        ミ3 & 94 & 164.5 & 164.8 & -0.3 \\
        ファ3 & 88 & 175.6 & 174.6 & +1.0 \\
        ファ\#3 & 83 & 186.0 & 185.0 & +1.0 \\
        ソ3 & 79 & 195.3 & 196.0 & -0.7 \\
        ソ\#3 & 74 & 208.3 & 207.7 & +0.6 \\
        ラ3 & 70 & 220.1 & 220.0 & +0.1 \\
        ラ\#3 & 66 & 233.2 & 233.1 & +0.1 \\
        シ3 & 62 & 248.0 & 246.9 & +1.1 \\  
      \end{tabular}
    \end{minipage}
    \hspace{2mm}
    \begin{minipage}[h]{0.5\hsize}
      \centering
      \caption{音の即値や周波数などについて2} 
      \label{Hz2}
      \begin{tabular}{c|c|c|c|c}
        音名 & 即値 & 周波数 & \parbox{3zw}{本来の周波数} & 誤差 \\
        \hline
        ド4 & 59 & 260.4 & 261.6 & -1.2 \\
        ド\#4 & 55 & 279.0 & 277.2 & +1.8 \\
        レ4 & 52 & 294.8 & 293.7 & +1.1 \\ 
        レ\#4 & 49 & 312.5 & 311.1 & +1.4 \\
        ミ4 & 46 & 332.4 & 329.6 & +2.8 \\
        ファ4 & 44 & 347.2 & 349.2 & -2.0 \\
        ファ\#4 & 42 & 363.4 & 367.0 & -3.6 \\
        ソ4 & 39 & 390.6 & 392.0 & -1.4 \\
        ソ\#4 & 37 & 411.2 & 415.3 & -4.1 \\
        ラ4 & 35 & 434.0 & 440.0 & -6.0 \\
        ラ\#4 & 33 & 459.6 & 466.2 & -6.6 \\
        シ4 & 31 & 488.3 & 493.9 & -5.6 \\
        ド5 & 29 & 520.8 & 523.3 & -2.5 \\
        ド\#5 & 28 & 538.8 & 554.4 & -15.6 \\
        レ5 & 26 & 578.7 & 587.3 & -8.6 \\
        レ\#5 & 24 & 625.0 & 622.3 & +2.7 \\
        ミ5 & 23 & 651.0 & 659.7 & -8.7 \\
        ファ5 & 22 & 679.3 & 698.5 & -19.2 \\
        ファ\#5 & 20 & 744.0 & 740.0 & 0 \\
        ソ5 & 19 & 781.3 & 784.0 & -2.7 \\
        ソ\#5 & 18 & 822.4 & 830.6 & -8.2 \\
        ラ5 & 17 & 868.1 & 880.0 & -11.9 \\
        ラ\#5 & 16 & 919.1 & 932.3 & -13.2 \\
        シ5 & 15 & 976.6 & 987.8 & -11.2 \\
      \end{tabular}
    \end{minipage}
  \end{tabular}
\end{table}
\end{document}
